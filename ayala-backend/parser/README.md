# Парсер компаний Алматы - statsnet.co

Скрипт для парсинга данных компаний с сайта https://statsnet.co/states/kz/almaty с использованием Playwright.

## Установка

1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Установите браузеры для Playwright:
```bash
playwright install
```

## Настройка прокси

В файле `main.py` есть список прокси-серверов (только HTTP):
```python
PROXY_LIST = [
    {
        'server': 'http://94.131.2.254:40068',  # HTTP порт
        'username': 'NuhaiProxy_VP3eYoUt',
        'password': 'Vh0VvZE9'
    }
    # Добавьте больше HTTP прокси здесь
]
```

⚠️ **Важно**: Chromium в Playwright не поддерживает SOCKS5 прокси с аутентификацией, поэтому используйте только HTTP прокси.

Вы можете:
- Добавить больше прокси-серверов в список
- Изменить частоту смены прокси (по умолчанию каждые 1000 компаний)
- Отключить прокси, сделав список пустым: `PROXY_LIST = []`

## Запуск

Запустите скрипт:
```bash
python main.py
```

Скрипт будет:
1. Парсить все страницы с компаниями
2. Автоматически менять прокси каждые 1000 компаний
3. Сохранять данные в отдельные файлы каждые 10 страниц
4. Создавать итоговый объединенный файл `almaty_complete.csv`

## Что парсится

Скрипт извлекает следующие данные о каждой компании:
- **name** - Название компании
- **address** - Адрес компании
- **activity** - Описание деятельности
- **manager** - ФИО руководителя
- **company_size** - Размер предприятия (количество сотрудников)
- **bin** - БИН (Бизнес-идентификационный номер)
- **nds** - НДС номер
- **link** - Ссылка на страницу компании на сайте

## Особенности

- Использует Playwright для обработки динамического контента
- **Поддержка прокси-серверов** с автоматической ротацией каждые 1000 компаний
- Автоматически обходит все страницы с результатами
- Включает задержки между запросами для избежания блокировки
- Сохраняет данные в CSV формате с кодировкой UTF-8
- Максимальное количество страниц ограничено 50 для безопасности
- Автоматическое объединение всех файлов в итоговый `almaty_complete.csv`

## Выходные файлы

Данные сохраняются в отдельные файлы каждые 10 страниц в формате `data/almaty_pages_X-Y.csv`. Каждый файл содержит данные в следующем формате:
```csv
name,address,activity,manager,company_size,bin,nds,link,status
"КОМПАНИЯ ООО","Казахстан, г.Алматы...","Торговля","Иванов И.И.","Малое предприятие 10-20 чел.","123456789","12345-6789","https://statsnet.co/companies/kz/123456789","Активная"
```

### Пример файлов:
- `data/almaty_pages_1-10.csv` - данные с 1-й по 10-ю страницу
- `data/almaty_pages_11-20.csv` - данные с 11-й по 20-ю страницу
- и так далее... 